# ─────────────────────────────────────────────────────────────
# ProsektorWeb Dashboard - Environment Variables
# ─────────────────────────────────────────────────────────────
# Copy this file to .env.local and fill in the values

# ─────────────────────────────────────────────────────────────
# Supabase
# ─────────────────────────────────────────────────────────────
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# ─────────────────────────────────────────────────────────────
# Security Secrets (CRITICAL - Keep these secure!)
# ─────────────────────────────────────────────────────────────

# Public form site_token signing (server-only)
# Used for validating public form submissions
# Generate with: openssl rand -base64 32
SITE_TOKEN_SECRET=your-site-token-secret

# Custom JWT authentication secret (server-only)
# SECURITY: Must be different from SITE_TOKEN_SECRET
# Used for signing custom authentication JWTs
# Generate with: openssl rand -base64 32
CUSTOM_JWT_SECRET=your-custom-jwt-secret

# ─────────────────────────────────────────────────────────────
# Database (for migrations & RLS tests)
# ─────────────────────────────────────────────────────────────
DATABASE_URL=postgresql://postgres:postgres@localhost:54322/postgres

# ─────────────────────────────────────────────────────────────
# App Config
# ─────────────────────────────────────────────────────────────
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_SITE_NAME=ProsektorWeb Dashboard

# ─────────────────────────────────────────────────────────────
# Rate Limiting (optional)
# ─────────────────────────────────────────────────────────────
RATE_LIMIT_MAX_REQUESTS=5
RATE_LIMIT_WINDOW_MS=60000
# Number of trusted reverse-proxy hops for X-Forwarded-For parsing in production.
# 0 = right-most IP in chain, 1 = skip last proxy hop, etc.
TRUSTED_PROXY_COUNT=0

# Dashboard auth-based rate limit (read/search/export)
DASHBOARD_READ_RL_LIMIT=120
DASHBOARD_READ_RL_WINDOW_SEC=60
DASHBOARD_SEARCH_RL_LIMIT=30
DASHBOARD_SEARCH_RL_WINDOW_SEC=60
DASHBOARD_EXPORT_RL_LIMIT=3
DASHBOARD_EXPORT_RL_WINDOW_SEC=600

# Dashboard summary cache TTL (seconds)
DASHBOARD_SUMMARY_CACHE_TTL_SEC=20

# Bootstrap super admin accounts (comma-separated emails)
# Example: SUPER_ADMIN_EMAILS=admin@prosektor.com,ops@prosektor.com
SUPER_ADMIN_EMAILS=

# Public endpoint rate limits (IP-based)
# Contact form: 5 requests per 60 seconds per IP
PUBLIC_CONTACT_RL_LIMIT=5
PUBLIC_CONTACT_RL_WINDOW_SEC=60

# Offer form: 5 requests per 60 seconds per IP
PUBLIC_OFFER_RL_LIMIT=5
PUBLIC_OFFER_RL_WINDOW_SEC=60

# HR application: 3 requests per 300 seconds per IP (stricter due to file uploads)
PUBLIC_HR_APPLY_RL_LIMIT=3
PUBLIC_HR_APPLY_RL_WINDOW_SEC=300

# ─────────────────────────────────────────────────────────────
# Storage
# ─────────────────────────────────────────────────────────────
MAX_CV_FILE_SIZE_MB=5
MAX_MEDIA_FILE_SIZE_MB=10
STORAGE_BUCKET_PRIVATE_CV=private-cv
STORAGE_BUCKET_PUBLIC_MEDIA=public-media

# Optional AV scanning for CV uploads (ClamAV)
# Enable in production when clamd is reachable from the API container.
AV_SCAN_ENABLED=false
# If true, reject uploads when AV service is unavailable.
AV_SCAN_FAIL_CLOSED=false
CLAMAV_HOST=127.0.0.1
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_MS=2500

# ─────────────────────────────────────────────────────────────
# Email (for notifications - optional)
# ─────────────────────────────────────────────────────────────
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASS=
# EMAIL_FROM=noreply@example.com

# ─────────────────────────────────────────────────────────────
# AI CLI Tools (OAuth Authentication)
# ─────────────────────────────────────────────────────────────
# NOTE: Codex, Gemini, and Kilo use OAuth/login authentication (not API keys)
#
# First-time setup for local development:
#   - Codex:   `codex login`               → stores to ~/.codex/
#   - Gemini:  (auto Google OAuth)          → stores to ~/.gemini/
#   - Kilo:    `kilo auth login`            → stores to ~/.local/share/kilo/
#
# For Docker containers, mount these directories as volumes:
#   - ~/.codex:/root/.codex
#   - ~/.gemini:/root/.gemini
#   - ~/.local/share/kilo:/root/.local/share/kilo
#
# For CI/CD, use OIDC/Workflow Identity or token sharing (see docs/)
