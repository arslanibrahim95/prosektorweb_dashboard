# API (server) environment variables
# Supabase project URL. You can also use NEXT_PUBLIC_SUPABASE_URL, but SUPABASE_URL is preferred.
SUPABASE_URL=https://your-project.supabase.co

# Supabase anon key (used for user-scoped requests).
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# Supabase service role key (server-only, required).
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# ─────────────────────────────────────────────────────────────
# Security Secrets (CRITICAL - Keep these secure!)
# ─────────────────────────────────────────────────────────────

# Public form site_token signing (server-only).
# Used for validating public form submissions
# Generate with: openssl rand -base64 32
SITE_TOKEN_SECRET=your-site-token-secret

# Custom JWT authentication secret (server-only, REQUIRED).
# SECURITY: Must be different from SITE_TOKEN_SECRET
# Used for signing custom authentication JWTs
# Generate with: openssl rand -base64 32
CUSTOM_JWT_SECRET=your-custom-jwt-secret

# Optional rate limiting defaults (if you decide to make them configurable later)
RATE_LIMIT_MAX_REQUESTS=5
RATE_LIMIT_WINDOW_MS=60000
# Number of trusted reverse-proxy hops for X-Forwarded-For parsing in production.
# 0 = right-most IP in chain, 1 = skip last proxy hop, etc.
TRUSTED_PROXY_COUNT=0

# Dashboard auth-based read/search/export rate limits
DASHBOARD_READ_RL_LIMIT=120
DASHBOARD_READ_RL_WINDOW_SEC=60
DASHBOARD_SEARCH_RL_LIMIT=30
DASHBOARD_SEARCH_RL_WINDOW_SEC=60
DASHBOARD_EXPORT_RL_LIMIT=3
DASHBOARD_EXPORT_RL_WINDOW_SEC=600

# Dashboard summary response cache (in-memory, seconds)
DASHBOARD_SUMMARY_CACHE_TTL_SEC=20

# Bootstrap super admin accounts (comma-separated emails)
# Example: SUPER_ADMIN_EMAILS=admin@prosektor.com,ops@prosektor.com
SUPER_ADMIN_EMAILS=

# Allowed web origins for sensitive auth endpoints (comma-separated).
# Note: Site/domain records are also checked dynamically, so this list is
# only for static explicit allow entries (e.g. main dashboard domains).
# Example: ALLOWED_WEB_ORIGINS=https://dashboard.prosektor.com,https://staging.prosektor.com
ALLOWED_WEB_ORIGINS=http://localhost:3000

# Optional storage config
STORAGE_BUCKET_PRIVATE_CV=private-cv
STORAGE_BUCKET_PUBLIC_MEDIA=public-media

# Optional AV scanning for CV uploads (ClamAV)
# Enable in production when clamd is reachable from the API container.
AV_SCAN_ENABLED=false
# If true, reject uploads when AV service is unavailable.
AV_SCAN_FAIL_CLOSED=false
CLAMAV_HOST=127.0.0.1
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_MS=2500

# ─────────────────────────────────────────────────────────────
# Builder Integration
# ─────────────────────────────────────────────────────────────

# Secret used to sign webhooks sent to the Builder (must match Builder's secret)
WEBHOOK_SECRET=your-webhook-secret

# URL of the Builder API to send webhooks to
BUILDER_API_URL=https://builder.prosektor.com
